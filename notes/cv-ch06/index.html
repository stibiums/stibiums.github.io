<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> CV - 6: 相机标定 (Camera Calibration) | STIBIUMS_WEB </title> <meta name="author" content="stibiums liu"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/touxiang.jpg?68b4199d95528c9129ff55a104244865"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://stibiums.github.io/notes/cv-ch06/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> STIBIUMS_WEB </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/notes/">notes <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">CV - 6: 相机标定 (Camera Calibration)</h1> <p class="post-meta"> Created on October 10, 2025 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2025   ·   <i class="fa-solid fa-hashtag fa-sm"></i> notes   <i class="fa-solid fa-hashtag fa-sm"></i> CV   <i class="fa-solid fa-hashtag fa-sm"></i> computer-vision   <i class="fa-solid fa-hashtag fa-sm"></i> camera-calibration   <i class="fa-solid fa-hashtag fa-sm"></i> 3d-vision   <i class="fa-solid fa-hashtag fa-sm"></i> triangulation   ·   <i class="fa-solid fa-tag fa-sm"></i> CV </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="61-3d视觉概述">6.1 3D视觉概述</h2> <p><strong>3D视觉</strong>的核心目标是从2D图像重建3D结构。这是计算机视觉中的基础问题之一。</p> <h3 id="核心挑战单视图歧义性">核心挑战：单视图歧义性</h3> <p>给定一个相机和一张图像，许多3D点可能投影到同一个2D像素位置。这就是3D视觉的根本难题——<strong>单视图歧义性</strong>。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/notes_img/cv-ch06/single_view_ambiguity-480.webp 480w,/assets/img/notes_img/cv-ch06/single_view_ambiguity-800.webp 800w,/assets/img/notes_img/cv-ch06/single_view_ambiguity-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/notes_img/cv-ch06/single_view_ambiguity.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="单视图歧义性问题" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>上图展示了单视图歧义性问题：从相机中心发出的一条射线上的所有3D点（标记为X?）都会投影到图像平面上的同一个像素点x。仅凭一个视角，我们无法确定3D点的真实深度位置。</p> <p><strong>关键问题</strong>：如何解决单视图歧义性？</p> <h2 id="62-解决单视图歧义的方法">6.2 解决单视图歧义的方法</h2> <h3 id="方法1主动传感">方法1：主动传感</h3> <p>使用激光、结构光等主动发射光线到场景中，通过测量反射时间或模式畸变直接获取深度信息。</p> <p><strong>典型设备</strong>：</p> <ul> <li>激光扫描仪（LiDAR）：通过激光飞行时间测距</li> <li>Kinect（结构光）：投射红外结构光模式并分析畸变</li> <li>ToF相机：测量光的飞行时间</li> </ul> <h3 id="方法2立体视觉">方法2：立体视觉</h3> <p>使用两个已标定的相机从不同视角观察同一场景，通过三角测量原理从对应点恢复深度。类似于人类的双眼视觉系统。</p> <h3 id="方法3多视图几何">方法3：多视图几何</h3> <p>移动相机拍摄多张照片，通过寻找不同视角下的对应关系来恢复3D点\(\mathbf{X}\)和相机位置。这是<strong>运动恢复结构（Structure from Motion, SfM）</strong>的基础。</p> <h3 id="方法4形状从明暗-shape-from-shading">方法4：形状从明暗 (Shape from Shading)</h3> <p>固定相机位置，在不同光照条件下拍摄多张照片。通过分析表面法线如何影响明暗变化，重建物体的3D几何信息。适用于精细表面细节的恢复。</p> <h3 id="方法5数据驱动学习">方法5：数据驱动学习</h3> <p>训练深度神经网络直接从单张图像预测3D信息（如深度图）。网络通过学习大量标注数据，隐式地学习了场景的先验知识和几何规律。</p> <h3 id="3d视觉任务概览">3D视觉任务概览</h3> <p>主要任务包括：</p> <ul> <li> <strong>相机标定</strong>：估计内参矩阵</li> <li> <strong>立体视觉</strong>：从2张图像估计深度图</li> <li> <strong>运动恢复结构</strong>：从2+张图像恢复相机和点云</li> <li> <strong>形状从明暗</strong>：从2+张不同光照图像恢复3D几何</li> </ul> <h2 id="63-相机参数回顾">6.3 相机参数回顾</h2> <h3 id="相机投影公式">相机投影公式</h3> \[\mathbf{x} \cong \mathbf{K}[\mathbf{R} \mid \mathbf{t}]\mathbf{X}\] \[\begin{bmatrix} x \\ y \\ 1 \end{bmatrix} \cong \begin{bmatrix} f &amp; s &amp; c_x \\ 0 &amp; \alpha f &amp; c_y \\ 0 &amp; 0 &amp; 1 \end{bmatrix} \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \end{bmatrix} \begin{bmatrix} \mathbf{R}_{3\times3} &amp; \mathbf{0}_{3\times1} \\ \mathbf{0}_{1\times3}^T &amp; 1 \end{bmatrix} \begin{bmatrix} \mathbf{I}_{3\times3} &amp; \mathbf{T}_{3\times1} \\ \mathbf{0}_{1\times3}^T &amp; 1 \end{bmatrix} \begin{bmatrix} X \\ Y \\ Z \\ 1 \end{bmatrix}\] <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/notes_img/cv-ch06/camera_parameters-480.webp 480w,/assets/img/notes_img/cv-ch06/camera_parameters-800.webp 800w,/assets/img/notes_img/cv-ch06/camera_parameters-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/notes_img/cv-ch06/camera_parameters.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="相机参数图示" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>上图展示了相机坐标系统：红色、绿色、蓝色箭头表示世界坐标系的三个轴；相机中心经过旋转\(\mathbf{R}\)和平移\(\mathbf{t}\)变换后建立相机坐标系（深色箭头）；橙色点表示3D空间中的点，通过相机中心投影到图像平面上。</p> <h3 id="内参矩阵-mathbfk">内参矩阵 \(\mathbf{K}\)</h3> \[\mathbf{K} = \begin{bmatrix} f &amp; s &amp; c_x \\ 0 &amp; \alpha f &amp; c_y \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\] <p><strong>参数说明</strong>：</p> <ul> <li>\(f\)：焦距（focal length）</li> <li>\(\alpha\)：纵横比（aspect ratio），等于1除非像素非正方形</li> <li>\(s\)：倾斜（skew），等于0除非像素为平行四边形</li> <li>\((c_x, c_y)\)：主点（principal point），等于图像中心\((w/2, h/2)\)除非光轴不过图像中心</li> </ul> <h3 id="外参矩阵-mathbfr-mid-mathbft">外参矩阵 \([\mathbf{R} \mid \mathbf{t}]\)</h3> <ul> <li>\(\mathbf{R}\)：旋转矩阵（\(3 \times 3\)），描述世界坐标系到相机坐标系的旋转</li> <li>\(\mathbf{t}\)：平移向量（\(3 \times 1\)），描述世界坐标系到相机坐标系的平移</li> </ul> <h3 id="相机矩阵分解">相机矩阵分解</h3> \[\boldsymbol{\Pi} = \begin{bmatrix} p_{11} &amp; p_{12} &amp; p_{13} &amp; p_{14} \\ p_{21} &amp; p_{22} &amp; p_{23} &amp; p_{24} \\ p_{31} &amp; p_{32} &amp; p_{33} &amp; p_{34} \end{bmatrix}\] <p>可以分解为：</p> \[\boldsymbol{\Pi} = \mathbf{K}[\mathbf{R} \mid \mathbf{t}]\] <p>其中：</p> <ul> <li>\(\mathbf{K}\)是上三角矩阵</li> <li>\(\mathbf{R}\)是正交矩阵</li> </ul> <p>可以通过<strong>RQ分解</strong>恢复\(\mathbf{K}\)和\(\mathbf{R}\)。</p> <h2 id="64-相机标定问题">6.4 相机标定问题</h2> <h3 id="问题定义">问题定义</h3> <p>给定\(n\)个已知3D坐标\(\mathbf{X}_i\)和对应的图像投影\(\mathbf{x}_i\)的点，估计相机参数。通常使用标定板（如棋盘格）来提供已知的3D-2D对应关系。</p> <p><strong>输入</strong>：</p> <ul> <li>3D世界坐标：\((X_i, Y_i, Z_i)\)</li> <li>对应的2D图像坐标：\((x_i, y_i)\)</li> </ul> <p><strong>输出</strong>：</p> <ul> <li>相机矩阵\(\boldsymbol{\Pi}\)或分解后的\(\mathbf{K}, \mathbf{R}, \mathbf{t}\)</li> </ul> <h2 id="65-相机标定线性方法">6.5 相机标定：线性方法</h2> <h3 id="推导过程">推导过程</h3> <p>投影关系：</p> \[\mathbf{x}_i \cong \boldsymbol{\Pi}\mathbf{X}_i\] \[\begin{bmatrix} x \\ y \\ 1 \end{bmatrix} \cong \begin{bmatrix} p_{11} &amp; p_{12} &amp; p_{13} &amp; p_{14} \\ p_{21} &amp; p_{22} &amp; p_{23} &amp; p_{24} \\ p_{31} &amp; p_{32} &amp; p_{33} &amp; p_{34} \end{bmatrix} \begin{bmatrix} X \\ Y \\ Z \\ 1 \end{bmatrix}\] <p>展开后：</p> \[x_i = \frac{p_{11}X_i + p_{12}Y_i + p_{13}Z_i + p_{14}}{p_{31}X_i + p_{32}Y_i + p_{33}Z_i + p_{34}}\] \[y_i = \frac{p_{21}X_i + p_{22}Y_i + p_{23}Z_i + p_{24}}{p_{31}X_i + p_{32}Y_i + p_{33}Z_i + p_{34}}\] <h3 id="叉积形式">叉积形式</h3> <p>利用\(\mathbf{x}_i \times \boldsymbol{\Pi}\mathbf{X}_i = \mathbf{0}\)：</p> \[\mathbf{x}_i \times \boldsymbol{\Pi}\mathbf{X}_i = \begin{bmatrix} x_i \\ y_i \\ 1 \end{bmatrix} \times \begin{bmatrix} \mathbf{P}_1^T\mathbf{X}_i \\ \mathbf{P}_2^T\mathbf{X}_i \\ \mathbf{P}_3^T\mathbf{X}_i \end{bmatrix} = \mathbf{0}\] <p>这给出3个方程，但只有2个线性独立（第3个是前两个的线性组合）。</p> <h3 id="线性方程组">线性方程组</h3> <p>每个点对产生2个方程，对于\(n\)个点：</p> \[\mathbf{A}_{2n \times 12}\mathbf{p}_{12} = \mathbf{0}_{2n}\] <p>其中\(\mathbf{p}\)是\(\boldsymbol{\Pi}\)矩阵的12个元素组成的向量。</p> <h3 id="最小点数">最小点数</h3> <ul> <li> <strong>未知数</strong>：11个自由度（12个元素，尺度不变性减1）</li> <li> <strong>方程数</strong>：每个点2个方程</li> <li> <strong>所需点数</strong>：至少6个不共面的点</li> </ul> <h3 id="最小二乘解">最小二乘解</h3> <p>实际应用中通常有更多对应点，最小化：</p> \[E = \|\mathbf{A}\mathbf{p}\|^2 + \lambda(\|\mathbf{p}\|^2 - 1)\] <p>对\(\mathbf{p}\)求导并令其为0：</p> \[\mathbf{A}^T\mathbf{A}\mathbf{p} = \lambda\mathbf{p}\] <p><strong>解</strong>：\(\mathbf{p}\)是\(\mathbf{A}^T\mathbf{A}\)<strong>最小特征值对应的特征向量</strong>。</p> <p>\(E = \lambda\)（最小特征值）</p> <h2 id="66-rq分解">6.6 RQ分解</h2> <h3 id="qr分解回顾">QR分解回顾</h3> <p><strong>QR分解</strong>是对矩阵\(\mathbf{A}\)的列进行Gram-Schmidt正交化，从第一列开始：</p> \[\mathbf{A} = \begin{bmatrix} \mathbf{a}_1 &amp; \mathbf{a}_2 &amp; \cdots &amp; \mathbf{a}_n \end{bmatrix} = \begin{bmatrix} \mathbf{e}_1 &amp; \mathbf{e}_2 &amp; \cdots &amp; \mathbf{e}_n \end{bmatrix} \begin{bmatrix} \mathbf{a}_1 \cdot \mathbf{e}_1 &amp; \mathbf{a}_2 \cdot \mathbf{e}_1 &amp; \cdots &amp; \mathbf{a}_n \cdot \mathbf{e}_1 \\ 0 &amp; \mathbf{a}_2 \cdot \mathbf{e}_2 &amp; \cdots &amp; \mathbf{a}_n \cdot \mathbf{e}_2 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; \mathbf{a}_n \cdot \mathbf{e}_n \end{bmatrix} = \mathbf{Q}\mathbf{R}\] <h3 id="rq分解">RQ分解</h3> <p><strong>RQ分解</strong>是对矩阵\(\mathbf{A}\)的行进行Gram-Schmidt正交化，从最后一行开始。</p> <p>对于估计的相机矩阵\(\boldsymbol{\Pi} = \mathbf{K}[\mathbf{R} \mid \mathbf{t}]\)（\(3 \times 4\)）：</p> <ol> <li>对左侧\(3 \times 3\)子矩阵\(\mathbf{M}\)进行RQ分解得到\(\mathbf{K}\)和\(\mathbf{R}\)</li> <li>计算平移向量\(\mathbf{t} = \mathbf{K}^{-1}\mathbf{p}_4\)</li> </ol> <h2 id="67-相机标定线性vs非线性">6.7 相机标定：线性vs非线性</h2> <h3 id="线性方法">线性方法</h3> <p><strong>优点</strong>：</p> <ul> <li>易于公式化和求解</li> <li>计算效率高</li> <li>适合初始化</li> </ul> <p><strong>缺点</strong>：</p> <ul> <li>不直接给出相机参数（需要RQ分解）</li> <li>不能加入约束（如径向畸变）</li> <li>最小化代数误差而非几何误差</li> </ul> <h3 id="非线性方法">非线性方法</h3> <p>在实际应用中，<strong>非线性方法更受青睐</strong>。</p> <p><strong>目标函数</strong>（几何误差）：</p> \[\min_{\mathbf{K},\mathbf{R},\mathbf{t}} \sum_{i=1}^n \|\text{proj}(\mathbf{K}[\mathbf{R}\mid\mathbf{t}]\mathbf{X}_i) - \mathbf{x}_i\|_2^2\] <p>其中\(\text{proj}\)表示透视除法：\(\text{proj}\begin{bmatrix} x \\ y \\ z \end{bmatrix} = \begin{bmatrix} x/z \\ y/z \end{bmatrix}\)</p> <p><strong>优化方法</strong>：</p> <ul> <li>使用非线性优化包（如Levenberg-Marquardt）</li> <li>用线性方法的结果初始化</li> <li>可以加入畸变参数、正交性约束等</li> </ul> <h2 id="68-三角测量-triangulation">6.8 三角测量 (Triangulation)</h2> <h3 id="问题定义-1">问题定义</h3> <p>给定一个3D点在两个或多个图像中的投影（已知相机矩阵），求该点的3D坐标。这是相机标定的逆问题。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/notes_img/cv-ch06/triangulation_problem-480.webp 480w,/assets/img/notes_img/cv-ch06/triangulation_problem-800.webp 800w,/assets/img/notes_img/cv-ch06/triangulation_problem-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/notes_img/cv-ch06/triangulation_problem.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="三角测量问题" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>上图展示了三角测量的几何原理：两个不同位置的相机（蓝色和绿色三角形）观察同一个3D点（红色球），该点在两个图像平面（半透明平面）上产生投影。通过已知的相机位置和投影点，可以计算两条视线的交点，从而恢复3D点的位置。</p> <p><strong>输入</strong>：</p> <ul> <li>已知相机矩阵\(\boldsymbol{\Pi}_1, \boldsymbol{\Pi}_2\)</li> <li>对应的图像点\(\mathbf{x}_1, \mathbf{x}_2\)</li> </ul> <p><strong>输出</strong>：</p> <ul> <li>3D点\(\mathbf{X}\)</li> </ul> <h3 id="理想vs实际情况">理想vs实际情况</h3> <p><strong>理想情况</strong>：两条视线应该精确相交于3D点\(\mathbf{X}\)。</p> <p><strong>实际情况</strong>：由于噪声和数值误差，两条视线通常不会精确相交，而是相互错开。因此需要寻找最优的3D点位置，使其到两条视线的距离最小（几何方法）或重投影误差最小（优化方法）。</p> <h2 id="69-三角测量方法">6.9 三角测量方法</h2> <h3 id="方法1几何方法">方法1：几何方法</h3> <p>找到连接两条视线的<strong>最短线段</strong>（即两条异面直线的公垂线），取其中点作为\(\mathbf{X}\)的估计。这是一个直观的几何解法，计算简单。</p> <h3 id="方法2非线性优化">方法2：非线性优化</h3> <p>最小化重投影误差：</p> \[\min_{\mathbf{X}} \|\text{proj}(\boldsymbol{\Pi}_1\mathbf{X}) - \mathbf{x}_1\|_2^2 + \|\text{proj}(\boldsymbol{\Pi}_2\mathbf{X}) - \mathbf{x}_2\|_2^2\] <p>这种方法寻找最优的3D点\(\mathbf{X}\)，使得其投影回两个图像平面后，与观测到的像素点之间的欧氏距离平方和最小。这是几何误差的直接优化，通常能得到更准确的结果。</p> <h3 id="方法3线性优化">方法3：线性优化</h3> <p>利用叉积形式：</p> \[\mathbf{x}_1 \cong \boldsymbol{\Pi}_1\mathbf{X} \Rightarrow \mathbf{x}_1 \times \boldsymbol{\Pi}_1\mathbf{X} = \mathbf{0}\] \[\mathbf{x}_2 \cong \boldsymbol{\Pi}_2\mathbf{X} \Rightarrow \mathbf{x}_2 \times \boldsymbol{\Pi}_2\mathbf{X} = \mathbf{0}\] <p>使用叉积矩阵形式：</p> \[\mathbf{a} \times \mathbf{b} = [\mathbf{a}]_\times\mathbf{b} = \begin{bmatrix} 0 &amp; -a_3 &amp; a_2 \\ a_3 &amp; 0 &amp; -a_1 \\ -a_2 &amp; a_1 &amp; 0 \end{bmatrix}\begin{bmatrix} b_1 \\ b_2 \\ b_3 \end{bmatrix}\] <p>得到：</p> \[\begin{bmatrix} [\mathbf{x}_1]_\times\boldsymbol{\Pi}_1 \\ [\mathbf{x}_2]_\times\boldsymbol{\Pi}_2 \end{bmatrix}\mathbf{X} = \mathbf{0}\] <p>每个相机提供2个方程（第3个是前两个的线性组合），对于3个未知数，用约束最小二乘求解：</p> \[\min_{\mathbf{X}} \|\mathbf{A}\mathbf{X}\|^2 \text{ subject to } \|\mathbf{X}\|^2 = 1\] <p><strong>解</strong>：\(\mathbf{X}\)是\(\mathbf{A}^T\mathbf{A}\)最小特征值对应的特征向量。</p> <h3 id="齐次坐标的优势">齐次坐标的优势</h3> <p>使用齐次坐标\(\mathbf{X} = (X, Y, Z, W)\)，约束\(\|\mathbf{X}\|^2 = 1\)，避免平凡解\(\mathbf{X} = \mathbf{0}\)。</p> <p>投影公式：</p> \[x_j = \frac{p_{11}^{(j)}X + p_{12}^{(j)}Y + p_{13}^{(j)}Z + p_{14}^{(j)}W}{p_{31}^{(j)}X + p_{32}^{(j)}Y + p_{33}^{(j)}Z + p_{34}^{(j)}W}\] \[y_j = \frac{p_{21}^{(j)}X + p_{22}^{(j)}Y + p_{23}^{(j)}Z + p_{24}^{(j)}W}{p_{31}^{(j)}X + p_{32}^{(j)}Y + p_{33}^{(j)}Z + p_{34}^{(j)}W}\] <h2 id="610-消失点标定">6.10 消失点标定</h2> <h3 id="消失点回顾">消失点回顾</h3> <p><strong>消失点</strong>是平行线在透视投影中的交点，代表了无穷远处的方向。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/notes_img/cv-ch06/vanishing_point_def-480.webp 480w,/assets/img/notes_img/cv-ch06/vanishing_point_def-800.webp 800w,/assets/img/notes_img/cv-ch06/vanishing_point_def-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/notes_img/cv-ch06/vanishing_point_def.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="消失点定义" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>上图展示了消失点的几何意义：建筑物的水平边缘线（红色和蓝色线）延伸后会聚于两个消失点VP1和VP2，垂直边缘线（绿色线）延伸后会聚于垂直消失点VP3。三个消失点对应于场景中三个正交的主方向，这些方向信息可以用来标定相机的内参。</p> <p>一条直线可以参数化为：</p> \[\mathbf{X}_t = \begin{bmatrix} X_0 + tD_1 \\ Y_0 + tD_2 \\ Z_0 + tD_3 \\ 1 \end{bmatrix} \cong \begin{bmatrix} X_0/t + D_1 \\ Y_0/t + D_2 \\ Z_0/t + D_3 \\ 1/t \end{bmatrix} \rightarrow \mathbf{X}_\infty = \begin{bmatrix} D_1 \\ D_2 \\ D_3 \\ 0 \end{bmatrix}\] <p>当\(t \to \infty\)时，点趋向于无穷远点\(\mathbf{X}_\infty\)，其投影为消失点：</p> \[\mathbf{v} \cong \boldsymbol{\Pi}\mathbf{X}_\infty\] <h3 id="使用消失点标定">使用消失点标定</h3> <p>如果世界坐标系没有已知的3D点坐标，在某些特殊场景下，可以使用<strong>消失点</strong>进行标定。这种方法特别适用于建筑物、室内环境等具有明显正交结构的场景。</p> <p><strong>适用场景</strong>：场景中存在三组<strong>正交</strong>的消失方向（如建筑物的长、宽、高三个方向）。</p> <h3 id="正交约束">正交约束</h3> <p>将世界坐标系与三个正交消失方向对齐：</p> \[\mathbf{e}_1 = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \quad \mathbf{e}_2 = \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}, \quad \mathbf{e}_3 = \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}\] <p>消失点\(\mathbf{v}_i\)对应于方向\(\mathbf{e}_i\)：</p> \[\mathbf{v}_i \cong \boldsymbol{\Pi}\begin{bmatrix} \mathbf{e}_i \\ 0 \end{bmatrix} = \mathbf{K}[\mathbf{R}\mid\mathbf{t}]\begin{bmatrix} \mathbf{e}_i \\ 0 \end{bmatrix} = \mathbf{K}\mathbf{R}\mathbf{e}_i\] <p>因为\(\mathbf{e}_i^T\mathbf{e}_j = 0\)（正交），所以：</p> \[\mathbf{e}_i \cong \mathbf{R}^T\mathbf{K}^{-1}\mathbf{v}_i\] \[\mathbf{v}_i^T\mathbf{K}^{-T}\mathbf{K}^{-1}\mathbf{v}_j = 0, \quad i \neq j\] <p>这个约束<strong>只包含内参矩阵\(\mathbf{K}\)</strong>。</p> <h3 id="求解内参">求解内参</h3> <p>假设\(\mathbf{K} = \begin{bmatrix} f &amp; 0 &amp; c_x \\ 0 &amp; f &amp; c_y \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)（简化模型，3个参数）</p> <p>约束方程数：</p> <ul> <li>3对消失点产生3个正交约束</li> </ul> \[\mathbf{v}_i^T\mathbf{K}^{-T}\mathbf{K}^{-1}\mathbf{v}_j = 0\] <p>展开\(\mathbf{K}^{-1}\)和\(\mathbf{K}^{-T}\)：</p> \[\mathbf{K}^{-1} = \begin{bmatrix} g &amp; 0 &amp; -gc_x \\ 0 &amp; g &amp; -gc_y \\ 0 &amp; 0 &amp; 1 \end{bmatrix}, \quad g = \frac{1}{f}\] \[\mathbf{K}^{-T} = \begin{bmatrix} g &amp; 0 &amp; 0 \\ 0 &amp; g &amp; 0 \\ -gc_x &amp; -gc_y &amp; 1 \end{bmatrix}\] <p>对于\(\mathbf{v}_i = (x_i, y_i, w_i)^T\)：</p> \[\mathbf{v}_i^T\mathbf{K}^{-T}\mathbf{K}^{-1}\mathbf{v}_j = g^2(x_ix_j + y_iy_j) - g^2c_x(w_ix_j + w_jx_i) - g^2c_y(w_iy_j + w_jy_i) + g^2(c_x^2 + c_y^2)w_iw_j + w_iw_j = 0\] <p>这是关于\(g, c_x, c_y\)的非线性方程，但可以求解。</p> <p><strong>要求</strong>：至少<strong>两个有限消失点</strong>才能同时求解\(f\)和\((c_x, c_y)\)。</p> <p><strong>不同配置的影响</strong>：</p> <ul> <li> <strong>1个有限消失点 + 2个无限消失点</strong>：只能求解焦距，主点位置无法确定（假设为图像中心）</li> <li> <strong>2个有限消失点 + 1个无限消失点</strong>：可以同时求解焦距和主点位置</li> <li> <strong>3个有限消失点</strong>：过约束系统，可以更鲁棒地求解所有参数</li> </ul> <h3 id="从消失点恢复旋转">从消失点恢复旋转</h3> <p>已知\(\mathbf{K}\)后，恢复旋转矩阵\(\mathbf{R}\)：</p> \[\mathbf{K}^{-1}\mathbf{v}_i \cong \mathbf{R}\mathbf{e}_i\] <p>注意到\(\mathbf{R}\mathbf{e}_1 = \begin{bmatrix} \mathbf{r}_1 &amp; \mathbf{r}_2 &amp; \mathbf{r}_3 \end{bmatrix}\begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} = \mathbf{r}_1\)</p> <p>因此：\(\mathbf{r}_i \cong \mathbf{K}^{-1}\mathbf{v}_i\)</p> <p>尺度歧义通过正交性约束消除：\(\|\mathbf{r}_i\|^2 = 1\)</p> <p>最终得到：\(\mathbf{r}_i = \frac{\mathbf{K}^{-1}\mathbf{v}_i}{\|\mathbf{K}^{-1}\mathbf{v}_i\|}\)</p> <h3 id="消失点标定的优缺点">消失点标定的优缺点</h3> <p><strong>优点</strong>：</p> <ul> <li>无需标定板</li> <li>无需2D-3D对应关系</li> <li>可以完全自动化</li> </ul> <p><strong>缺点</strong>：</p> <ul> <li>只适用于特定场景（需要正交消失方向）</li> <li>消失点定位精度影响标定结果</li> <li>至少需要两个有限消失点</li> </ul> <h2 id="611-总结">6.11 总结</h2> <h3 id="3d视觉的关键问题">3D视觉的关键问题</h3> <p>从图像重建3D结构的核心是解决<strong>单视图歧义性</strong>。</p> <p><strong>主要方法</strong>：</p> <ol> <li>主动传感（激光、结构光）</li> <li>立体视觉（双目）</li> <li>多视图几何（运动恢复结构）</li> <li>形状从明暗</li> <li>深度学习</li> </ol> <h3 id="相机标定">相机标定</h3> <p><strong>相机矩阵</strong>：\(\mathbf{x} \cong \boldsymbol{\Pi}\mathbf{X} = \mathbf{K}[\mathbf{R} \mid \mathbf{t}]\mathbf{X}\)</p> <p><strong>线性标定</strong>：</p> <ul> <li>给定\(n \geq 6\)个3D-2D对应点</li> <li>构造线性方程组\(\mathbf{A}\mathbf{p} = \mathbf{0}\)</li> <li>通过特征值分解求解</li> <li>使用RQ分解恢复\(\mathbf{K}, \mathbf{R}, \mathbf{t}\)</li> </ul> <p><strong>非线性标定</strong>（实际更常用）：</p> <ul> <li>最小化几何误差（重投影误差）</li> <li>可以加入畸变参数</li> <li>用线性方法初始化</li> </ul> <p><strong>消失点标定</strong>：</p> <ul> <li>利用场景中的正交消失方向</li> <li>通过正交约束求解内参</li> <li>适用于建筑物等人造环境</li> </ul> <h3 id="三角测量">三角测量</h3> <p>给定已知相机矩阵和对应点，求3D点坐标。</p> <p><strong>方法</strong>：</p> <ol> <li> <strong>几何方法</strong>：找最短连接线段的中点</li> <li> <strong>非线性优化</strong>：最小化重投影误差</li> <li> <strong>线性方法</strong>：利用叉积约束，特征值分解</li> </ol> <p><strong>实际应用</strong>：两条视线通常不精确相交，需要鲁棒估计。</p> <h3 id="关键技术要点">关键技术要点</h3> <ul> <li> <strong>齐次坐标</strong>：统一处理各种变换和投影</li> <li> <strong>RQ分解</strong>：从相机矩阵恢复内外参</li> <li> <strong>特征值分解</strong>：求解线性约束最小化问题</li> <li> <strong>几何误差vs代数误差</strong>：非线性优化更准确</li> <li> <strong>正交约束</strong>：用于消失点标定和旋转矩阵恢复</li> </ul> <p><strong>参考文献</strong>：Computer Vision: Algorithms and Applications, 第11章</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/09/08/notesof_ML/">notes of ML</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/09/08/notesofvci/">notes of VCI</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/09/08/notesofaip/">notes of AIP</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/09/08/notesof_aimath/">notes of AI Math Fundamentals</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/09/08/notesof_ICS/">notes of ICS</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 stibiums liu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: October 12, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?58fdb075e5aa03fbb8617845abde746c"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>