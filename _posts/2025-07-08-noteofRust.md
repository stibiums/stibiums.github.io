---
layout: post
title: notes of Rustlearning
date: 2025-07-08 08:00:00
description: è¿™æ˜¯æˆ‘å­¦ä¹ Rustè¯­è¨€çš„ç¬”è®°.
tags: notes
categories: my-notes
toc:
  sidebar: left
---

å­¦ä¹ ä½¿ç”¨çš„[æ•™ç¨‹](https://kaisery.github.io/trpl-zh-cn/title-page.html)

## hello world å’Œ hello cargo

### hello world

åˆ›å»ºä¸€ä¸ªä»¥`hello.rs`æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```rust
fn main() {
    println!("Hello, world!");
}
```

ç„¶ååœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼š

```bash
rustc hello.rs
./hello
```

ä¾¿ä¼šè¿è¡Œè¾“å‡º`Hello, world!`ã€‚è¿™æ˜¯æœ€ç®€å•ç¼–å†™è¿è¡ŒRustç¨‹åºçš„æ–¹å¼ã€‚

### cargo

Cargo æ˜¯ Rust çš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å™¨ã€‚ä½¿ç”¨ Cargo æ¥ç®¡ç† Rust é¡¹ç›®ï¼Œå®ƒå¯ä»¥ä¸ºä½ å¤„ç†å¾ˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚æ„å»ºä»£ç ã€ä¸‹è½½ä¾èµ–åº“å¹¶ç¼–è¯‘è¿™äº›åº“ã€‚

ä½¿ç”¨cargoåˆ›å»ºé¡¹ç›®çš„æ–¹æ³•ï¼š

```bash
cargo new hello_cargo
cd hello_cargo
```

è¿›å…¥ hello_cargo ç›®å½•å¹¶åˆ—å‡ºæ–‡ä»¶ã€‚å°†ä¼šçœ‹åˆ° Cargo ç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶å’Œä¸€ä¸ªç›®å½•ï¼šä¸€ä¸ª Cargo.toml æ–‡ä»¶ï¼Œä¸€ä¸ª src ç›®å½•ï¼Œä»¥åŠä½äº src ç›®å½•ä¸­çš„ main.rs æ–‡ä»¶ã€‚

å¦‚æœè¦åœ¨å·²æœ‰çš„æ–‡ä»¶é‡Œä½¿ç”¨ Cargoï¼Œå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
cargo init
```

### ç¼–è¯‘å’Œè¿è¡Œ

åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
cargo build
```

è¿™ä¼šç¼–è¯‘é¡¹ç›®å¹¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚å¯æ‰§è¡Œæ–‡ä»¶ä½äº `target/debug/` ç›®å½•ä¸‹ã€‚å¦‚æœéœ€è¦å‘å¸ƒæ—¶å¯ä»¥åŠ ä¸Šå‚æ•°`--release`ï¼Œè¿™æ ·ä¼šè¿›è¡Œä¼˜åŒ–ç¼–è¯‘ï¼š

è¦è¿è¡Œé¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```bash
cargo run
```

Cargo è¿˜æä¾›äº†ä¸€ä¸ªå« `cargo check` çš„å‘½ä»¤ã€‚è¯¥å‘½ä»¤å¿«é€Ÿæ£€æŸ¥ä»£ç ç¡®ä¿å…¶å¯ä»¥ç¼–è¯‘ï¼Œä½†å¹¶ä¸äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶

## å¸¸è§ç¼–ç¨‹æ¦‚å¿µçš„è¿ç§»

### å˜é‡å’Œå¯å˜æ€§

#### å˜é‡çš„å®šä¹‰

åœ¨ Rust ä¸­ï¼Œä½¿ç”¨`let`å£°æ˜ä¸€ä¸ªå˜é‡ã€‚å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ã€‚è¦å£°æ˜ä¸€ä¸ªå¯å˜å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨ `mut` å…³é”®å­—ï¼š

```rust
let x = 5; // ä¸å¯å˜å˜é‡
let mut y = 10; // å¯å˜å˜é‡
```

å¦‚æœå°è¯•ä¿®æ”¹ä¸å¯å˜å˜é‡ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚Rustçš„ç¼–è¯‘å™¨ä¼šä¿è¯ä¸å¯å˜çš„å˜é‡ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚

#### å¸¸é‡

å¸¸é‡ä½¿ç”¨ `const` å…³é”®å­—å£°æ˜ï¼Œåœ¨å£°æ˜æ—¶ä¹Ÿå¿…é¡»æŒ‡æ˜å…¶æ•°æ®ç±»å‹ï¼Œå¿…é¡»åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šå€¼ã€‚å¸¸é‡å¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸä¸­ä½¿ç”¨ï¼ŒåŒ…æ‹¬å‡½æ•°å†…éƒ¨å’Œå¤–éƒ¨ã€‚

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

å¸¸é‡å¯ä»¥ç”¨å¸¸é‡è¡¨è¾¾å¼æ¥å®šä¹‰

åœ¨å£°æ˜å®ƒçš„ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå¸¸é‡åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­éƒ½æœ‰æ•ˆ

#### é®è”½

é®è”½æ˜¯æŒ‡ä½¿ç”¨åŒåå˜é‡æ¥éšè—ä¹‹å‰çš„å˜é‡ã€‚å¯ä»¥é€šè¿‡é‡æ–°å£°æ˜ä¸€ä¸ªå˜é‡æ¥é®è”½ä¹‹å‰çš„å˜é‡ã€‚

ç¬¬äºŒä¸ªå˜é‡é®è”½äº†ç¬¬ä¸€ä¸ªå˜é‡ï¼Œæ­¤æ—¶ä»»ä½•ä½¿ç”¨è¯¥å˜é‡åçš„è¡Œä¸ºä¸­éƒ½ä¼šè§†ä¸ºæ˜¯åœ¨ä½¿ç”¨ç¬¬äºŒä¸ªå˜é‡ï¼Œç›´åˆ°ç¬¬äºŒä¸ªå˜é‡è‡ªå·±ä¹Ÿè¢«é®è”½æˆ–ç¬¬äºŒä¸ªå˜é‡çš„ä½œç”¨åŸŸç»“æŸã€‚

```rust
fn main() {
    let x = 5;

    let x = x + 1;

    {
        let x = x * 2;
        println!("The value of x in the inner scope is: {x}");
    }

    println!("The value of x is: {x}");
}
```

é®è”½å’Œå˜é‡ä¿®æ”¹æ˜¯æœ‰ä¸åŒçš„ï¼›é®è”½åˆ›å»ºçš„æ–°çš„å˜é‡ï¼Œä¿®æ”¹åŸæ¥çš„å˜é‡åˆ™æ˜¯æ”¹å˜åŸæ¥çš„å˜é‡çš„å€¼ã€‚

### æ•°æ®ç±»å‹

Rust æ˜¯ä¸€ç§é™æ€ç±»å‹çš„è¯­è¨€ï¼Œåœ¨ç¼–è¯‘æ—¶å°±å¿…é¡»ç¡®å®šæ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚åœ¨å®šä¹‰å˜é‡æˆ–è€…å¸¸é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹æ³¨è§£æ¥æŒ‡å®šå˜é‡çš„ç±»å‹ã€‚

æœ‰ä¸¤ç§æ•°æ®ç±»å‹ï¼šæ ‡é‡ç±»å‹å’Œå¤åˆç±»å‹ã€‚

#### æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹è¡¨ç¤ºå•ä¸€çš„å€¼ã€‚Rust ä¸­æœ‰å››ç§åŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼å’Œå­—ç¬¦ã€‚

##### æ•´å‹

ä»¥ä¸‹æ˜¯ Rust ä¸­æ•´å‹çš„ç®€æ´è¡¨æ ¼ï¼š

| **ç±»å‹** | **é•¿åº¦** | **èŒƒå›´**                        |
| -------- | -------- | ------------------------------- |
| `i8`     | 8 ä½     | -2â· åˆ° 2â·-1                     |
| `u8`     | 8 ä½     | 0 åˆ° 2â¸-1                       |
| `i16`    | 16 ä½    | -2Â¹âµ åˆ° 2Â¹âµ-1                   |
| `u16`    | 16 ä½    | 0 åˆ° 2Â¹â¶-1                      |
| `i32`    | 32 ä½    | -2Â³Â¹ åˆ° 2Â³Â¹-1                   |
| `u32`    | 32 ä½    | 0 åˆ° 2Â³Â²-1                      |
| `i64`    | 64 ä½    | -2â¶Â³ åˆ° 2â¶Â³-1                   |
| `u64`    | 64 ä½    | 0 åˆ° 2â¶â´-1                      |
| `isize`  | å¹³å°ç›¸å…³ | å–å†³äºæ“ä½œç³»ç»Ÿï¼ˆ32 ä½æˆ– 64 ä½ï¼‰ |
| `usize`  | å¹³å°ç›¸å…³ | å–å†³äºæ“ä½œç³»ç»Ÿï¼ˆ32 ä½æˆ– 64 ä½ï¼‰ |

---

**è¯´æ˜**ï¼š

1. **`i` è¡¨ç¤ºæœ‰ç¬¦å·æ•´å‹**ï¼Œå¯ä»¥è¡¨ç¤ºæ­£æ•°å’Œè´Ÿæ•°ã€‚
2. **`u` è¡¨ç¤ºæ— ç¬¦å·æ•´å‹**ï¼Œåªèƒ½è¡¨ç¤ºéè´Ÿæ•°ã€‚
3. **`isize` å’Œ `usize`** æ˜¯å¹³å°ç›¸å…³çš„æ•´å‹ç±»å‹ï¼š
   - åœ¨ 32 ä½ç³»ç»Ÿä¸Šï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ 32 ä½ã€‚
   - åœ¨ 64 ä½ç³»ç»Ÿä¸Šï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ 64 ä½ã€‚
4. **é»˜è®¤ç±»å‹**ï¼šå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šç±»å‹ï¼ŒRust ä¼šé»˜è®¤ä½¿ç”¨ `i32` ç±»å‹ã€‚

##### æµ®ç‚¹å‹

Rust çš„æµ®ç‚¹æ•°ç±»å‹æ˜¯ f32 å’Œ f64ï¼Œåˆ†åˆ«å  32 ä½å’Œ 64 ä½ã€‚é»˜è®¤ç±»å‹æ˜¯ f64

##### å¸ƒå°”å‹

å¸ƒå°”ç±»å‹åªæœ‰ä¸¤ä¸ªå€¼ï¼štrue å’Œ falseã€‚å¯ä»¥ä½¿ç”¨ `bool` ç±»å‹æ¥å£°æ˜

##### å­—ç¬¦å‹

å­—ç¬¦ç±»å‹ä½¿ç”¨ `char` ç±»å‹æ¥è¡¨ç¤ºï¼Œè¡¨ç¤ºå•ä¸ª Unicode å­—ç¬¦ã€‚å­—ç¬¦ç±»å‹æ˜¯å››ä¸ªå­—èŠ‚ï¼ˆ32 ä½ï¼‰ï¼Œå¯ä»¥è¡¨ç¤ºä»»ä½•æœ‰æ•ˆçš„ Unicode å­—ç¬¦ï¼Œå¸¦å˜éŸ³ç¬¦å·çš„å­—æ¯ï¼ˆAccented lettersï¼‰ï¼Œä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ç­‰å­—ç¬¦ï¼Œemojiï¼ˆç»˜æ–‡å­—ï¼‰ä»¥åŠé›¶é•¿åº¦çš„ç©ºç™½å­—ç¬¦éƒ½æ˜¯æœ‰æ•ˆçš„ char å€¼

```rust
fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // with explicit type annotation
    let heart_eyed_cat = 'ğŸ˜»';
}
```

#### å¤åˆç±»å‹

å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªå€¼ã€‚Rust ä¸­æœ‰ä¸¤ç§åŸºæœ¬çš„å¤åˆç±»å‹ï¼šå…ƒç»„å’Œæ•°ç»„ã€‚

##### å…ƒç»„

å…ƒç»„æ˜¯å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªå¤åˆç±»å‹ã€‚å…ƒç»„çš„å…ƒç´ å¯ä»¥æ˜¯ä¸åŒç±»å‹çš„ã€‚å…ƒç»„ä½¿ç”¨å°æ‹¬å· `()` æ¥è¡¨ç¤ºï¼Œå…ƒç´ ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    let (x, y, z) = tup; // æ”¯æŒè§£æ„

    println!("The value of y is: {y}");
}
```

å¯ä»¥ä½¿ç”¨`.` åŠ ä¸Šç´¢å¼•æ¥è®¿é—®å…ƒç»„çš„å…ƒç´ 

##### æ•°ç»„

æ•°ç»„æ˜¯å›ºå®šé•¿åº¦çš„åŒç±»å‹å…ƒç´ çš„é›†åˆã€‚æ•°ç»„ä½¿ç”¨æ–¹æ‹¬å· `[]` æ¥è¡¨ç¤ºï¼Œå…ƒç´ ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚

```rust
fn main() {
    let a: [i32; 5] = [1, 2, 3, 4, 5]; //æ–¹æ‹¬å·ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œåè·Ÿåˆ†å·ï¼Œå†åè·Ÿæ•°ç»„å…ƒç´ çš„æ•°é‡
    let a = [3; 5]; // åˆ›å»ºä¸€ä¸ªåŒ…å« 5 ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ çš„å€¼éƒ½æ˜¯ 3
    let first = a[0]; // è®¿é—®æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
}
```

### å‡½æ•°

#### å®šä¹‰

åœ¨ Rust ä¸­é€šè¿‡è¾“å…¥ fn åé¢è·Ÿç€å‡½æ•°åå’Œä¸€å¯¹åœ†æ‹¬å·æ¥å®šä¹‰å‡½æ•°ã€‚Rust ä¸å…³å¿ƒå‡½æ•°å®šä¹‰æ‰€åœ¨çš„ä½ç½®ï¼Œåªè¦å‡½æ•°è¢«è°ƒç”¨æ—¶å‡ºç°åœ¨è°ƒç”¨ä¹‹å¤„å¯è§çš„ä½œç”¨åŸŸå†…å°±è¡Œã€‚

åœ¨å‡½æ•°çš„ç­¾åä¸­ï¼Œå¿…é¡»å£°æ˜æ¯ä¸€ä¸ªå‚æ•°çš„ç±»å‹ã€‚

```rust
fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("The measurement is: {value}{unit_label}");
}
```

#### è¯­å¥å’Œè¡¨è¾¾å¼

- **è¯­å¥**ï¼šæ˜¯æ‰§è¡Œä¸€äº›æ“ä½œä½†ä¸è¿”å›å€¼çš„æŒ‡ä»¤ã€‚ä»¥åˆ†å·ç»“å°¾
- **è¡¨è¾¾å¼**ï¼šè®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¯ä»¥åµŒå¥—ã€‚ä¸ä¼šä»¥åˆ†å·ç»“å°¾

```rust
fn main() {
    let y = {
        let x = 3;
        x + 1
    };

    println!("The value of y is: {y}");
}
```

#### å‡½æ•°è¿”å›å€¼

å‡½æ•°å¯ä»¥è¿”å›å€¼ï¼Œä½¿ç”¨ `->` è¯­æ³•æ¥æŒ‡å®šè¿”å›å€¼çš„ç±»å‹ã€‚å‡½æ•°çš„è¿”å›å€¼ç­‰åŒäºå‡½æ•°ä½“æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚

```rust
fn five() -> i32 {
    5 // æ³¨æ„è¿™é‡Œæ²¡æœ‰åˆ†å·ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼
}
```

### æ§åˆ¶æµ

#### `if`

`if` è¡¨è¾¾å¼ç”¨äºæ¡ä»¶åˆ¤æ–­ã€‚å¯ä»¥ä½¿ç”¨ `else if` å’Œ `else` æ¥å¤„ç†å…¶ä»–æƒ…å†µã€‚

```rust
fn main() {
    let number = 6;
    if number % 4 == 0 {
        println!("Number is divisible by 4");
    } else if number % 3 == 0 {
        println!("Number is divisible by 3");
    } else {
        println!("Number is not divisible by 4 or 3");
    }
}
```

æ³¨æ„çš„æ˜¯ä»£ç ä¸­çš„æ¡ä»¶å¿…é¡»æ˜¯ bool å€¼ã€‚å¦‚æœæ¡ä»¶ä¸æ˜¯ bool å€¼ï¼Œå°†ä¼šæŠ¥é”™ã€‚Rustå¹¶ä¸ä¼šå°è¯•å°†å…¶ä»–ç±»å‹è½¬æ¢ä¸ºå¸ƒå°”å€¼ã€‚

å› ä¸º`if`æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶ç»“æœèµ‹å€¼ç»™å˜é‡ã€‚

```rust
let condition = true;
let number = if condition { 5 } else { 6 }; // æ³¨æ„è¿™é‡Œçš„ elseåˆ†æ”¯ä¹Ÿå¿…é¡»è¿”å›ç›¸åŒç±»å‹çš„å€¼ï¼ˆRustéœ€è¦åœ¨ç¼–è¯‘æ—¶å°±æ˜ç¡®å˜é‡çš„ç±»å‹ï¼‰
println!("The value of number is: {number}");
```

#### `loop`

`loop` ç”¨äºåˆ›å»ºæ— é™å¾ªç¯ã€‚å¯ä»¥ä½¿ç”¨ `break` é€€å‡ºå¾ªç¯ï¼Œä½¿ç”¨ `continue` è·³è¿‡å½“å‰è¿­ä»£ã€‚

`break` å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ä½œä¸ºå¾ªç¯çš„ç»“æœã€‚

```rust
fn main() {
    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {result}");
}
```

å¯ä»¥åˆ©ç”¨å¾ªç¯æ ‡ç­¾æ¥æ ‡è®°å¾ªç¯ï¼Œä»¥ä¾¿åœ¨åµŒå¥—å¾ªç¯ä¸­ä½¿ç”¨ `break` æˆ– `continue` æ—¶æŒ‡å®šè¦è·³å‡ºæˆ–ç»§ç»­çš„å¾ªç¯ã€‚

```rust
fn main() {
    'outer: loop {
        println!("Entered the outer loop");
        loop {
            println!("Entered the inner loop");
            break 'outer; // è·³å‡ºå¤–å±‚å¾ªç¯
        }
        println!("This line will not be printed");
    }
    println!("Exited the outer loop");
}
```

#### `while`

`while` å¾ªç¯åœ¨æ¡ä»¶ä¸º `true` æ—¶æ‰§è¡Œã€‚å¯ä»¥åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ `break` å’Œ `continue` æ¥æ§åˆ¶å¾ªç¯ã€‚

#### `for`

`for` å¾ªç¯ç”¨äºéå†é›†åˆæˆ–èŒƒå›´ã€‚å¯ä»¥ä½¿ç”¨ `in` å…³é”®å­—æ¥æŒ‡å®šè¦éå†çš„é›†åˆæˆ–èŒƒå›´ã€‚

```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("the value is: {element}");
    }
}
```

## æ‰€æœ‰æƒ

**æ‰€æœ‰æƒ**æ˜¯ Rust çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚Rust é€šè¿‡æ‰€æœ‰æƒç³»ç»Ÿæ¥ç®¡ç†å†…å­˜ï¼Œç¡®ä¿å†…å­˜å®‰å…¨å’Œé˜²æ­¢æ•°æ®ç«äº‰ã€‚

- rust ä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ã€‚
- æ¯ä¸ªå€¼åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
- å½“æ‰€æœ‰è€…ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå€¼ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ã€‚

### å˜é‡çš„ä½œç”¨åŸŸ
